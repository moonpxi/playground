(require '[clojure.string :as st])

(defn fasta-records [ds]
  (let [raw-records (map st/split-lines (rest (st/split ds #">")))]
    (map (fn [raw] {:id (first raw), 
                    :dna (st/join (rest raw))}) 
         raw-records)))

(defn digraph-edges [records]
  (for [a records
        b records
        :when (and (not= a b)
                   (= (take-last 3 (a :dna)) (take 3 (b :dna))))]
    [(a :id) (b :id)]))

(def ds-sample
">Rosalind_0498
AAATAAA
>Rosalind_2391
AAATTTT
>Rosalind_2323
TTTTCCC
>Rosalind_0442
AAATCCC
>Rosalind_5013
GGGTGGG")

(def ds
">Rosalind_3590
GTGCGAACTGTCATATCCCGAGATAACTACACTAATACGAATACGACAAAACAGTGATAG
CCGAGCTAGCTCATACGCTCATTGATTCGAGT
>Rosalind_8128
GGTCTATCAGAATTATTACTGAGAGGACCAAGAAGGCACCCTTTCTGCCGTGGAATCCGT
AAGAGTTGGTACTGATGTGGGAGAGCCTACTGTAGCCCCT
>Rosalind_3741
GTATTACGAGAGTTGTGCGCTTCCCAGATTCCGACGCGAGGTCCAAGGTTCTTTGACAAA
AGCACGTAATTCACAATCGTAACCAAACGA
>Rosalind_3886
ACGGTGCGCGAACATGTCCTTTGCCTGTAGTGGTTTACGCTGCGGGCCTCGGAACCTCAA
GTATGAAACTGCCGTCGCGCTCTCCGTGA
>Rosalind_6719
AACACAGTTTCGTCATAACAAAGCTTATCATATTCCCGATTGCCGAGGACAAGGGTCATA
TGACGTGCAGTTCGGAGATCGCA
>Rosalind_3448
ATAAACCACCATCAATACATACGGTAAAGAGTGGGCGGGGGGCTTGGGGGTGGTAGAGGT
CCACGTGCCTGGCCGTTAGGCGA
>Rosalind_6177
CGCGTAGGTCCTCCTCCCGGGATTACCCACAATGTCCCGTTTACGGGACACTCGAACACA
ACTTCGTTGCGGTCTAGCAATGTATATTGGGTCATCGA
>Rosalind_5997
TTCGCGGGACGAATTCCCGCGTATCCTTTGAATTTAGATGGTGTGGGTCACCGGTAGACG
TCTCACGTATGGCCCGAAGCTTTGTATTAATCAC
>Rosalind_9428
CCCTACGTAACCTCAAGCCGGTCCCCCCATTTGTGGCAACGATTACAATGTGCAGCGGAC
ACAATTCCATCCTATCAGGGTGGATGTCAGCAGAATACA
>Rosalind_3781
CAAGCCTCCAATCCACTTGTAGGTTTCCAATACCTAGCCACCATCTAACACAACGACCAA
GCGCATCCGCCAACCTAACTACCAGAAACGAGGGAAGTGC
>Rosalind_1559
GCGTTCATATGAGGCGCTACACAATATCAATAACGACTTATATGGCTTGAGGGGAATCTT
CACGAGAAGAGCCATCATAAAC
>Rosalind_0555
CAGGGGAGGGGTTTACGTGCACGGACGAACCCGGCTAATGCAGCCAGAAGCGTGTTAGTA
CACGCCAACTGAAGCGCTCATCGAGACTGCGGATCATT
>Rosalind_3289
GTTTAACCGAGAGCTGCCACTCGACGCGGGATAGAGTAACTATCCCAACCTCTCATAGCT
CAGGGTAGGCCGGCTGATTACAGAGGAAGC
>Rosalind_4436
ATAAGTGCATCTGCGACCCGTGCTGTTTATAAAGAGAAGATACCGAGCACCCCTGAGCAG
GCACTCCATGGGCGACTGGCTGCCCCCTTTCATGTG
>Rosalind_3320
ATGAGCCCACCGAGATCCAGGAACTTGCCTACGGATACGTTTCCATAAGATACGCGAAAC
AGTGCAAGGACACGGCTGAATAAAGCGGGTAAGGCT
>Rosalind_7877
CGGAATCGATTATAAAAGACACGCTCGCCAAGCATCAACAGTGGTTCGCCTAGGCCCACT
GTACATGTGTTGGCCTGTAACAATCCCTGC
>Rosalind_1287
AAAGTGCGCGCTCGTCAGGCCGGGCCTGTAGCGACCAGCCCCACAATGACAAGGACTGGT
ACTACTTGAGGTACCTACAAACGTT
>Rosalind_5563
ACAAAGAAGTATAGCCATGCGGATGAGCCAAATACGTGCCGATCTGTCGATACTTCATAG
GGAACTATCAGGTGACGTCTACACGGTTAGC
>Rosalind_8462
GGTTTCCCTCTCATCTCAGTCGAGGGAAGCTGGCGCCCAAGGACGGGTTACCAAGTCTTC
TGTATACACTTGAAAGACTAA
>Rosalind_4652
TAAAAGACAGATCCTGTCCTATTAAAGGGTAGAGTTTGAGGATGGCACCCCCGGCGCGTA
GTCGCGGGGACGCTGTAATTAGCA
>Rosalind_0993
TTAGGAGTCCATCAAGCGTATCATCAGGCCCCGCTCGTCTGTTAATGTTACGTACTTGGC
AAAGCATCTGCAACTTCGTAATA
>Rosalind_9733
CAACCGCGGTATAAGAGGTCCTAAGGCTCGATGCCATCATATGGTCAAGAGCAGCAATAA
TTTACACAGTTATATGGGGGGGCAGTCTACGACCCTAC
>Rosalind_4354
TGTCACACATATCAGTGCTGAATTGCTTGACGTGGTGGTCGGCGGCTTGTCCACCATTGC
GCTATATTTCCGCGACGTGTTGCATCACGGAACAA
>Rosalind_9785
AAGGCGTATGAACCGAATAACACAAGTACATTGAATTTCCGAGCTGCCCTGCAACTCGAT
ACGGTAGAGACGTTTCTTGGTAATTGTTCTACGCC
>Rosalind_0763
CTACTTATCGGGCGGTTAATAGGCTATTGGCGTTTGTCCTGAATAAGCAGGAATAGCGCC
TGATGCCGTAATTACGCTGCCGATAT
>Rosalind_7565
CTTACCTAGGCATTTGTGAACGGTTGGGGACATACCCACTTTCTTGGGAACCATCGAAAA
CTCGGGGGCCGGTCTCACATGTATGCCGGAA
>Rosalind_2881
CACCTTCATTCTCTTTTTTTGTCGGATGGCAGCTTCATTGATCCTCGGTACACCGAGGCC
TTCTCGTCTTTCTAACTACTACGCGCGC
>Rosalind_1172
GCACAGCTCATAGCTCTCGCCCGCGAACTAAAGACTTATGGCTTGTTAGAGCTCTACTCG
TCGGCGGTTCGCACGGTATGCCGTCAA
>Rosalind_2791
ATCTTACTTCCTAAGAAGTAGCACTCCTCCTGGCAGCGCGGTTAATGTGCCATACATGAG
GTCTATTTGATTTGCATCTC
>Rosalind_9150
TACCCTCCTTGGTTACTCGAACGAATTCATCCTTGGGCTCAGCAGCTTGCGGTATAGCCG
GAGTTGGGGGTGTAGTCCAGCAGCCAATTCCGA
>Rosalind_9450
GCTACCGTCCGTGTAGCCGAAATCTTAGGTCTGAATAATTAGTTGTGTCTTAACTTATAG
TTAGTGCCCGATGTTCCGTGTAGCATCAG
>Rosalind_4995
CCATCCTCTAAATTAAGTAGACATGGCCGTCAGGACTGCTGCCTTAACGGTAACAAAACA
GGTCCGTGAGACCCATGTTGCGCATCTTGT
>Rosalind_6137
GCTAAAAGTCGAGGCGCCGGAGGGAAGACAACGTTTTATATGCACCCTAGAGTCTGCATT
ACACAGCAAATCCCGCGAAGGGTTCGGA
>Rosalind_5768
GCACACGCTTGGATACTATAGCCTAAGCTTGACACGCGTAGAACGCCCTACTCTAGCCGT
ACAACCGCCGGCCGACCACCTCTGCGGCGAATT
>Rosalind_1586
CGCTCCTGAGACGCGGCGGGATGAAAGCATCAGAAGGCTCCAGACCATGGAACGCTGGAG
GGTCTCAAGGTATCAGGTCAGGCGTCT
>Rosalind_0997
TATCCCACTGGGGCTCAAGTCAGGGACATTACAATGTACGAAATTAACTTATAGTATCAA
TGTAAGCCACAGCCTTGTCGTATCTTACTATCTCTTTT
>Rosalind_5014
GGCGTGCGAAACAAGTCCGAAAACCGGTACAGCGTTGTGCCGCCCTAGACACTGATCACC
CTCCGCACCAGAGGCTCGCGGAATGACGTTTC
>Rosalind_2604
GAGCTTCGGCAGACCACTTGGGTCTTGGTAGAAAGATTTTCATTGTCAAAAATGTGCAAG
AGTTGGCGTCTTCGTACGCGGACCGCAGGCTAA
>Rosalind_8394
CTTCTTGCTCTGCTGGGGTACGAGACGGTAACGACCAAGACTGTAGGCGCTCGTGGGGCC
AGGTGTATCTGGCCATACAA
>Rosalind_1904
TATCTAAAAGAAGCAATGAAGGGTTCGTGCAAAGGTCAACCTAACGAATTACCGGAATTT
TCCAAGCATAATAGGTCACATTAT
>Rosalind_4753
AACCTCCAAGCGTATCGAGATTACTTTAGGAATACGTAGTTGTCGCCCTGCGCTAACCTG
TAGAAGGGTTGAGGAATAAGTT
>Rosalind_6304
ATTGCTCCCATTTAATAAGGGAGGCATCGTCGATTTCTGACAGGGCTTGGGTTGAGGAAA
GAGGGTGCCGGACTCTGATTCCTCACCTA
>Rosalind_6399
TGCTACATCAGATCCTCCCCAATTTGATGGAAACGATAATGTCGAGCGATCAGATCGGCG
ACCTGACTGTCCGACGTACGAACAAGT
>Rosalind_3708
CTTCAGATGCTCGATCCGGGTACAGGTGATCCTTAGCCACTGACGTGCGTTGGTTTCACT
GGAAGTAGAGATCGACCGCTA
>Rosalind_7741
TGCAAACTTGCTCTCGACCACTCGGCTTGCCCTCACATCGAGACCGTTATAATACCACTG
ATGTGGTCAGCCATCACCCCCGTACGCCA
>Rosalind_6979
AAGTCGGCCATGCCGATTGATGTAACCGCGACCGAAGGAACAGATTAGCCCTTTGCTATT
CAAGGGTCAGTCGAGTCAGCT
>Rosalind_5515
AAACAGCCGCGGATTGTTGTTATTTGGTGGAAATGGGAATCGAGTTTGCAAGACCCTATG
TGTTTAAGCACCACTTCGAGAGGAATGTTCGAGTTA
>Rosalind_8919
TTTGCACCGGTCGCCCGTAATGAACGTACAGCTGGGGGTCGGGGAAGCTGGGGACTTGTC
ATCGCTTCAGCGATAAAGCGGGGACAACCCCCAGGCAAAT
>Rosalind_9497
GTGCCAAAAGCTATGTTCAAACATTATGGATGGGTTCATAATAGTTACCAATTCCGCCGA
AGCAGGGTCTGTGCCGTCACAATATTCTGC
>Rosalind_1153
AAAGGCGTCCGGGCCCGCACGTGGCAGGAGGCACCAATTACTCAACCCTGCTCCCTCCCG
CGGTAGGGAAGCATCGGAGTGGTCTCACCTGCCAGATGA
>Rosalind_4082
TGAGTGCGCGCCCTGTGGAACCGCCAGTTGCGGAAATTTGCACAATCTGGAATCAAAGTC
AAGACGGTAGATGTGGTGAAATCGACACCCGTGCCTG
>Rosalind_9363
ACGGGTTTCCTTTCGTCACGACGAATCAGACTAACCTCAAGAAAATTAAGTTGCCATAGC
GAAGAGGATACGCGACACTGCA
>Rosalind_3247
CAATATACATCCAGCACTCGACAATGACCTCACCTTATGTAGGTTGATATGCGATACCCT
ACTACTCGGCGCCTCCAAACATCCTCTT
>Rosalind_8834
ATCCGCGGCCGTCCGTCACGACCAGCTCCTCCACGGTGTTACACCACGAAACTTTAGTGA
TTACGCATGAGTCTTCCATGAGTACACAATG
>Rosalind_5445
AAATCCTCGGGGGATTCAGCGATGATAACTCTATGCACAACGTATCGGACCGTCTGGTGA
AGGATCGCGATGCTCTGTCTCTATATGGTATTGGAATGC
>Rosalind_1881
ATTTGCGGACTTTAGTCTTTGACATGCATCGGAGCATAGTCTATCCATGGCGACTTATAC
CAGCGCGCACAGTCTCTATCGGTGACAA
>Rosalind_1186
AGTTCATTCAGGAACCAATCCTAGGCGCCGTGTCTATGCCGGGTCCTTTAAAGTCCCCAT
TTAAGAAACGAAGGAACTTGCGTCGGA
>Rosalind_4448
CGAGGGCGTATGTAATAGTAGGGTTTGCCAAGATCGGCCCCCCATGATTAGGATATTGAC
CGGACAGAAACCGTAGACCCCTTCGTATAAG
>Rosalind_1815
GGTGTAGGAGTAGGTTACATCAGGACTAAGTTGATCTAACTATAACTTAAGGTCGGTCGG
CCGAGAGGAAGTGAGAAATATAGGGTATGAGGTAC
>Rosalind_5387
ACATTGGCTAGGAGCCGAAGCACGTGGGCTGTGACTCGGTCAATCTTTTGTGCAGTGGCG
CCAATGTTCTTGAAGTGCATCTCAATAGA
>Rosalind_7400
AGAGAGTTCCCGTCCTGGTTTTAGTCTAACCCGTCGCATTCTTCTATGTCCGTTAAATTA
GACGTCTTAGCACGGTCCCAGCTAACC
>Rosalind_1644
AACAAGTCGGGAGCGTGCAATAGACGGTACGTCCTCACGCGAGCCTCGACTCAGAGATCC
GTCCTCACTGGAAGTGTAAACGTTGCGGAATGAGAGT
>Rosalind_0910
CACGCAGCGCCGTTGTTTACGGCTTAAAAACGTAGCGCTAACGTTCCCTAACCACCTTAT
GGAAGGTTTTCTTAACCATTACGAACTCCAAGG
>Rosalind_1609
GCTCTTTACACAACGCCACCTGTGATAGGTTCCTGGCTGTGGAGTCTCAAGGTACTAACC
CCAGATGTATGTTACAGTAAGTTAGGT
>Rosalind_5807
GAATTCCCATACCCTTGCATTAGGTATTTCGTCCCACCTTATGATCCGGCACAGCATAAA
AGATCCTAGCTCATCAATCTGGATAGGAATAATTATGC
>Rosalind_4518
GGCTCTTCACTACTTGTCAGCCAGCTTGTGAGTGTTAATTTAGGGACCCAGTCAGGGGTG
TGATCCTCGTAGGACATTTAGTTTGGATCCCCGG
>Rosalind_6400
GCATCCGCTGCCAATCGTCCAATACACTCAGCACGACGCAGTCGGGTAGCTGCCAGGCGG
GGTTCTCATTGGGCACGGGGGGTGTCACATCTGGCTGATG
>Rosalind_2264
GTTTGCCTGGTTTTGGGGTCGTGCCAAGGTCACATACGACAATCAATTGAATTTGGCATA
TGAAGGCCTCCATGCGTATTATTTTCCCTTAATG
>Rosalind_6109
GCTTCAGAGTCTCTTAAACGAAGGTGAGCCACTGTTCTTAGTCCTACTGCCTCTATGCAA
GGGGTAACCCAATATCACTGGCAACCCAATTGAGA
>Rosalind_7459
CACTGTTCCGGCGTGTAAAACAACCGGAGCCGGGGAACGGCCCGCATGAGAGCCCTTAGG
TGACCCGGTATCGTGGTCCCC
>Rosalind_7797
TCGGCCTGAGGTTTCCGTAAGAATGCCAAGAATGTTGGGAATAGACTTGCCGGCTAGGCT
CGGCAAGAGCCCTTAACATAAAACACAACCTCAGACCC
>Rosalind_5351
CGCCAAACGTTCCTGCTAAAAACGACGCGGCGGAGCCGAGAGTCCGGTCCTTTAGTTGCC
CAACGGGTAACTCCATCTCTTGT
>Rosalind_5058
AGGTTCCTTGAGTATTTTCGCGCATTGTGCATTTTGGTTCCACCCGAAACATCAACTCCA
AACGTGTATTGACCAGTGCGTAGACGAA
>Rosalind_0781
CTCATAAGCGTACTTGAGTGCTAAACGATGTGTACCACACACGTAATCGGCCTACAGCCT
GAGCCAATGGTGATAATGCGGTGG
>Rosalind_6593
CCTTTCTTAGCCAGACGCACCAGTCGCGTTACCCCCTTGAATCGAAACCCGTCCTTATTG
TCCCGGCTCTGTAACCATTGA
>Rosalind_4191
CGAGTATCCGACTCTCTGACGGGACGACTGTGGTGACACAAACGCTTCGTAGAGCACGCA
GGTCGGAGTCTTAGTGGACGCCCCC
>Rosalind_2073
TTTCTGAAATGATACCGGAAACCTCAGTCTGTTGCCTGTGCCGTCGGTACCAACCCAATC
CCTACCCGGCTTTTGAACGCTATTACCTGGCGAAAT
>Rosalind_6030
TTACTAATAGCTATTTTAACTGGTTACCCAATTAGTCGATTTGTCCCAATTCTAGGGTTT
GACCGGACCATGTCGTCCCCAATTGGTCAA
>Rosalind_2509
TGTGGCTCCCGACAGCCTTTAGATTGTGTAAGCTTTAATTAACGTGTTATTACACTATCT
TCGCCATCCATAGCGGTAAGGTTTGT
>Rosalind_9490
GGACAAGCAGAGTGCTGCTTTTCATGCCCCTACGGGCTGAACTGGCCAAAGTAAATATAT
AGTCCATGGCCAGGATATTATGTACAAGAGAAA
>Rosalind_4791
TTCCCGAGCCGCCGTAAGGCAGACGACGGCGCCTCAAAGACGTTTGACGAAAATCTGTCG
CGAACTGTATTAGCGTACTAATTAATGAGAATAA
>Rosalind_8999
CGTGCCTTCGCTGGCGCACTTTGCTTGAAAGCTATACGTTGGATTAGACCGCTTCTTATG
TCGATGAGTGAGCGTCACTTTAACTTCATTATA
>Rosalind_5718
GTAGAGGGAGGTTAAGGAAAGAGACCGGGGACTGCATGGCTCGCTTCGCGATGATAAGTT
CGAAATCCGGACGAGTAGAGGCGGGACACTGAGGGC
>Rosalind_3718
CGAGATTCAAGGCCCGTCGAGAAACCTTAAGATTTGCCCTGGACCGGGTGCTCCCTAGCT
ACTGGGCAGAAGCCTCGGCA
>Rosalind_6527
ATCTCCCGCCGTACATAAGATTACTTGGCCTATGCGGAGGGGCGCGATGTCACACTCCCC
ATTTCACGGTCCGTATGATCATAAACTGCTTTAAGAAC
>Rosalind_8076
CCTGCAACGGGAGCGCATCATACGACGGAACCGATTTCGTCCAAGTATGTCGACTTTGGA
TGAGCCTGGCACCGGAGGGATTTGA
>Rosalind_7381
TACCCAGTTCATACATCAAAAATCGCGCTATTAGTCGTCAGTTAATGGAAGAAGAGCTAA
ACATCGCTTGGTACACTATCGAGTAGCGGAT
>Rosalind_5898
GACCTTCATAACCGCGGGTCCGTATGGTCTGAACCGCTGCACGAGCCTGTAGAACCCATT
AAAGAGATCGCTACCGTGGGGGACTGT
>Rosalind_8003
GAGCACACCTGGGGGCAGCTCGAAGGCTAGGGTTATAGGTGCACACATGGCGCACCTGAC
AAGTCCGGTCTCCATTAAAGATCCTTGCA
>Rosalind_0699
ATACGTTATAATTAGACGCGCACATGTCCTAGACCGCCCAAGCCGGACCGCTAGATTTAA
GGTTCCGGAGATGACTAGCCAATCACCAAGCCC
>Rosalind_9338
GAGTGTTTGTCCCACTTGCGGAAGCTAAACCGATGTGATCTGCTGGAGCGGTGACTGTTC
TTTGCTAGGTACACAACTGCTTACCCC
>Rosalind_0852
TCGATCGTTGTTCAGGCAGAGAAGTACTGCAGATAGAGAGAAATTGGAAGTCGGATGCAC
GGATCGTGGTAGAGGCCGTTTG
>Rosalind_7936
TCCTTGTAAGTCGACTAGACTGGGCGTCACGAACGTGAGCTTTCTCACTAGCACCTGGGA
GATAAGCATTTGACTGCTCGAC
>Rosalind_9017
GTACCCCTTGGTGAGGAGTCGATACCGTATCATCCGACTCCGGCTTATTGGGGCTAGGGT
ATTATCATTCCAATTCCCAGTGGATATTT
>Rosalind_5274
TTAGCTCAGGATATGACTGCTGATGTGAGCAAGTAAGGACTTGTAGAAGGCTGCCAACGG
CAATATCTGAAGAAGTTGCGTAATCTTACGAATGAC
>Rosalind_9938
GATCGACCGCACGCCTCTACTTTTGCAAGGAAAGTCCGAACATCTCGACCTAATGCGCAA
GAAATCGTTTTGACTTGCAC
>Rosalind_2309
CTGGCTATGGTAAGAGGCGCAACCCTCAACCGCCCAGGCAGGAAAACCCACACCCTTAAG
ACCGGGGAGAGACAGACTAA
>Rosalind_1324
ATGCGAACCACGCGCCTCCCAGGGTTTGGACGAATTGGGGCGATTCACCGAGGGTAGATA
AATGGCATCTACTACGATCCTCTCGCTTGAGAC
>Rosalind_9688
CACCGTCCTCAGCGACGATATTGGTCCCCGTGCATATAATCACCACGGTGTCTTCTTCAA
AGCTCCCACTCGGGAAACAAGGGCCGACTC
>Rosalind_9633
TACAAGGATCTACGGTCAATCGTAGCCGGCACTTCCTATTCACTGTCCATTGGTAACCGC
TGCCATTGTCGCCGCTTTTGAGTGTCTCTGTTAG")

;(println (digraph-edges (fasta-records ds)))
(doseq [[a b] (digraph-edges (fasta-records ds))]
  (println a b))
